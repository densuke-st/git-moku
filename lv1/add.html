

<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>リポジトリ操作 &mdash; Gitもくもく勉強会(仮) 20210721 ドキュメント</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="レベル2: ブランチ操作" href="../lv2/index.html" />
    <link rel="prev" title="新規にリポジトリを作る" href="init.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Gitもくもく勉強会(仮)
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pre/index.html">はじめに</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup/index.html">環境構築</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats/index.html">gitってなんなのか</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">レベル1: ローカルコミット</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="clone.html">他の人のソースを取得する</a></li>
<li class="toctree-l2"><a class="reference internal" href="init.html">新規にリポジトリを作る</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">リポジトリ操作</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">ファイルの登録</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">コミット</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vscode">vscodeでの操作</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id4">ファイルを編集してみる</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">今度は自分でやってみよう</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lv2/index.html">レベル2: ブランチ操作</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lv3/index.html">レベル3: リポジトリ上での共有</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Gitもくもく勉強会(仮)</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">レベル1: ローカルコミット</a> &raquo;</li>
        
      <li>リポジトリ操作</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/lv1/add.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="lv1-add">
<span id="id1"></span><h1>リポジトリ操作<a class="headerlink" href="#lv1-add" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="section" id="id2">
<h2>ファイルの登録<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>ワークツリーとなったこのディレクトリ上にPythonのコードをひとつ作ってください。
作成方法は問いません。まずは基本となるコマンドラインからです。</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">コマンドラインからPythonスクリプトを作成(UNIX)</span><a class="headerlink" href="#id6" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">echo</span> <span class="s2">&quot;print(&#39;Hello&#39;)&quot;</span> &gt; sample1.py
<span class="gp">$</span> python sample1.py
<span class="go">Hello</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">コマンドラインからPythonスクリプトを作成(PowerShell)</span><a class="headerlink" href="#id7" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">PS&gt; echo &quot;print(&#39;Hello&#39;)&quot; | Out-File -Encoding utf8 sample1.py</span>
<span class="go">PS&gt; python sample1.py</span>
<span class="go">Hello</span>
</pre></div>
</div>
</div>
<p>この状態で、以下のコマンドを使ってみてください。</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">ファイル状態の確認</span><a class="headerlink" href="#id8" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="lineno"> 1 </span><span class="gp">$</span> git status
<span class="lineno"> 2 </span><span class="go">On branch development</span>
<span class="lineno"> 3 </span>
<span class="lineno"> 4 </span><span class="go">No commits yet</span>
<span class="lineno"> 5 </span>
<span class="lineno"> 6 </span><span class="go">Untracked files:</span>
<span class="lineno"> 7 </span><span class="go">(use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</span>
<span class="lineno"> 8 </span><span class="go">        sample1.py</span>
<span class="lineno"> 9 </span>
<span class="lineno">10 </span><span class="go">nothing added to commit but untracked files present (use &quot;git add&quot; to track)</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li><p>2行目: 「ブランチ」はコードの変更の流れに対する名称です、現在は <cite>main</cite> が主流ですが、先生は <cite>development</cite> にしています</p></li>
<li><p>4行目: 現在はまだ「コミットされていません」とのこと、コミットとは?</p></li>
<li><p>6行目: Un-track-ed(まだ <strong>追跡</strong> されていない)という状態、git的に野良なものであり、これを <strong>追加</strong> することで変更の <strong>追跡</strong> が行われるようになります</p></li>
</ul>
<p>ということで、追跡してもらうためにも追加処理を行います。</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">sample1.pyの追加</span><a class="headerlink" href="#id9" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="lineno">1 </span><span class="hll"><span class="gp">$</span> git add sample1.py
</span><span class="lineno">2 </span><span class="gp">$</span> git status
<span class="lineno">3 </span><span class="go">On branch development</span>
<span class="lineno">4 </span>
<span class="lineno">5 </span><span class="go">No commits yet</span>
<span class="lineno">6 </span>
<span class="lineno">7 </span><span class="go">Changes to be committed:</span>
<span class="lineno">8 </span><span class="go">(use &quot;git rm --cached &lt;file&gt;...&quot; to unstage)</span>
<span class="lineno">9 </span><span class="go">        new file:   sample1.py</span>
</pre></div>
</div>
</div>
<p>追加後に再度 <strong class="command">git status</strong> したところ、少し変化があります。</p>
<ul class="simple">
<li><p>1行目: 追加しました</p></li>
<li><p>7行目: 「コミットされるべき変更があります」という旨</p></li>
<li><p>9行目: 新規ファイルとしてのsample1.py</p></li>
</ul>
<p>このとき、ディレクトリ・ファイル達はこのような関係で構成されます。</p>
<div class="figure align-default" id="id10">
<img alt="../_images/repo-local-01.png" src="../_images/repo-local-01.png" />
<p class="caption"><span class="caption-text">add前の状態</span><a class="headerlink" href="#id10" title="この画像へのパーマリンク">¶</a></p>
</div>
<p>addすると、リポジトリ域の中に用意されている <strong>ステージ</strong> という領域に追加したファイルのコピーが配置されます。</p>
<div class="figure align-default" id="id11">
<img alt="../_images/repo-local-02.png" src="../_images/repo-local-02.png" />
<p class="caption"><span class="caption-text">add後の状態</span><a class="headerlink" href="#id11" title="この画像へのパーマリンク">¶</a></p>
</div>
<p>ステージ域は <strong>次にコミットされるべき情報</strong> が配置されます。
逆に考えれば、敢えてステージに入れなければコミットされないということになります。</p>
</div>
<div class="section" id="id3">
<h2>コミット<a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>コミットはステージに上げている状態のファイルをまとめて <strong>ひとつの状態として固定化する</strong> 行為となります。
一種のセーブポイントと考えて良いでしょう。</p>
<p>このとき <strong>なんのためのコミットか</strong> をきちんと書く必要がありますが、最低1行「なんのためか」を書けばさしあたりなんとかなります。
これはコミット処理を行う <strong class="command">git commit</strong> の時に <strong class="command">-m メッセージ</strong> で1行コメントを渡せます。</p>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">コミット</span><a class="headerlink" href="#id12" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="gp">$</span> git commit -m <span class="s2">&quot;練習用Pythonスクリプトの作成&quot;</span>
</span><span class="go">[development (root-commit) ad05401] 練習用Pythonスクリプトの作成</span>
<span class="go"> 1 file changed, 1 insertion(+)</span>
<span class="go"> create mode 100644 sample1.py</span>
</pre></div>
</div>
</div>
<p>この操作により、ステージに入っていたファイル <code class="file docutils literal notranslate"><span class="pre">sample1.py</span></code> は各種メタデータと一緒にまとめられてリポジトリにその時の状態で固定化されます。</p>
<p>この際、コミットIDと呼ばれる固有値(ハッシュ)が生成され、ステージ状態のスナップショットに対するアドレスとして機能するようになります。
上記の出力では <cite>ad05401</cite> が該当しています。</p>
<div class="figure align-default" id="id13">
<img alt="../_images/repo-local-03.png" src="../_images/repo-local-03.png" />
<p class="caption"><span class="caption-text">commit後の状態</span><a class="headerlink" href="#id13" title="この画像へのパーマリンク">¶</a></p>
</div>
<div class="section" id="vscode">
<h3>vscodeでの操作<a class="headerlink" href="#vscode" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>vscodeでも考え方は同じです。
リポジトリ内でファイルを作ると、ソース管理のアイコンに対象となり得るファイル数が通知で出力されます。</p>
<div class="figure align-default" id="id14">
<img alt="../_images/09-newfile-vscode.png" src="../_images/09-newfile-vscode.png" />
<p class="caption"><span class="caption-text">vscode上で新規(更新)が認識されている状態</span><a class="headerlink" href="#id14" title="この画像へのパーマリンク">¶</a></p>
</div>
<p>ソース管理に切り替えると、新規か更新されたファイルがリストアップされます。</p>
<div class="figure align-default" id="id15">
<img alt="../_images/10-files-vscode.png" src="../_images/10-files-vscode.png" />
<p class="caption"><span class="caption-text">作ったばかりのファイルのため、まだUntrack状態のファイルとして認識されている</span><a class="headerlink" href="#id15" title="この画像へのパーマリンク">¶</a></p>
</div>
<p>ということで、+ボタンを使って対象ファイルをステージに上げておきます。</p>
<div class="figure align-default" id="id16">
<img alt="../_images/11-staged-vscode.png" src="../_images/11-staged-vscode.png" />
<p class="caption"><span class="caption-text">ステージに上げた状態</span><a class="headerlink" href="#id16" title="この画像へのパーマリンク">¶</a></p>
</div>
<p>あとはコミットメッセージを書いて登録すればリポジトリにコミットされます。</p>
<div class="figure align-default" id="id17">
<img alt="../_images/12-commitmsg-vscode.png" src="../_images/12-commitmsg-vscode.png" />
<p class="caption"><span class="caption-text">メッセージを書いた状態、右上のチェック(✓)記号かCtrl+Enterでステージをコミットします</span><a class="headerlink" href="#id17" title="この画像へのパーマリンク">¶</a></p>
</div>
<p>コミット後、下部のcommitsを展開すると、コミット履歴として確認ができます。</p>
<div class="figure align-default" id="id18">
<img alt="../_images/13-commits-vscode.png" src="../_images/13-commits-vscode.png" />
<p class="caption"><span class="caption-text">コミット状態の確認</span><a class="headerlink" href="#id18" title="この画像へのパーマリンク">¶</a></p>
</div>
<p>ソース管理では、コミット状態のグラフとなるcommits意外に、現在操作中のファイルの変更履歴を見るfile historyなど、それなりに役立つ情報が確認できます。ただしこれらはgitの仕組みがある程度理解できないと使えないので、参考程度に見るようにしておきましょう。</p>
</div>
</div>
<div class="section" id="id4">
<h2>ファイルを編集してみる<a class="headerlink" href="#id4" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><code class="file docutils literal notranslate"><span class="pre">sample1.py</span></code> を編集し、出力内容を変更してみましょう。</p>
<div class="literal-block-wrapper docutils container" id="id19">
<div class="code-block-caption"><span class="caption-text">sample1.pyの修正(出力内容変更)</span><a class="headerlink" href="#id19" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;Hello, World&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>この場合、ステージ上に前の状態の <code class="file docutils literal notranslate"><span class="pre">sample1.py</span></code> ファイルが残っており、ワークツリー(<code class="file docutils literal notranslate"><span class="pre">.git</span></code> の外)の <code class="file docutils literal notranslate"><span class="pre">sample1.py</span></code> との間で内容が違うということになります。
この状態をgitは検出できます(<strong class="command">git status</strong>)。</p>
<div class="literal-block-wrapper docutils container" id="id20">
<div class="code-block-caption"><span class="caption-text">変更の検出</span><a class="headerlink" href="#id20" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> git status
<span class="go">On branch development</span>
<span class="go">Changes not staged for commit:</span>
<span class="go">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span>
<span class="go">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span>
<span class="hll"><span class="go">        modified:   sample1.py</span>
</span>
<span class="go">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span>
</pre></div>
</div>
</div>
<p>6行目にあるように「変更されている(modified)」というマークが付いています。
ステージ上に残っているものとの比較も可能です(<strong class="command">git diff</strong>)</p>
<div class="literal-block-wrapper docutils container" id="id21">
<div class="code-block-caption"><span class="caption-text">diffの取得</span><a class="headerlink" href="#id21" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> git diff
<span class="go">diff --git a/sample1.py b/sample1.py</span>
<span class="go">index c324c2e..f93eac0 100644</span>
<span class="go">--- a/sample1.py</span>
<span class="go">+++ b/sample1.py</span>
<span class="go">@@ -1 +1 @@</span>
<span class="go">-print(&#39;Hello&#39;)</span>
<span class="go">+print(&#39;Hello, World&#39;)</span>
</pre></div>
</div>
</div>
<p>diffはunified diff形式となっており、 &quot;-&quot;の部分が&quot;+&quot;に置換されることを示しています。</p>
<div class="figure align-default" id="id22">
<img alt="../_images/repo-local-04.png" src="../_images/repo-local-04.png" />
<p class="caption"><span class="caption-text">ワークツリー上を変更するとステージと食い違うことになる</span><a class="headerlink" href="#id22" title="この画像へのパーマリンク">¶</a></p>
</div>
<p>この状態を登録するために、追加してコミットしてみます。</p>
<div class="literal-block-wrapper docutils container" id="id23">
<div class="code-block-caption"><span class="caption-text">変更したファイルの追加コミット</span><a class="headerlink" href="#id23" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> 追加する
<span class="gp">$</span> git add sample1.py

<span class="gp">#</span> 状態確認 → 「次にコミットされる変更」に登録
<span class="gp">$</span> git status
<span class="go">On branch development</span>
<span class="go">Changes to be committed:</span>
<span class="go">(use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)</span>
<span class="go">        modified:   sample1.py</span>

<span class="gp">#</span> diffしても出ない<span class="o">(</span>ステージ上とワークツリーが同じになったため<span class="o">)</span>
<span class="gp">$</span> git diff
<span class="gp">#</span> コミット
<span class="gp">$</span> git commit -m <span class="s2">&quot;世界よこんにちは&quot;</span>
<span class="go">[development 43837ea] 世界よこんにちは</span>
<span class="go">1 file changed, 1 insertion(+), 1 deletion(-)</span>
</pre></div>
</div>
</div>
<div class="figure align-default" id="id24">
<img alt="../_images/repo-local-05.png" src="../_images/repo-local-05.png" />
<p class="caption"><span class="caption-text">修正したファイルのコミット</span><a class="headerlink" href="#id24" title="この画像へのパーマリンク">¶</a></p>
</div>
<p>同様の操作はvscodeでももちろん行えます。
<code class="file docutils literal notranslate"><span class="pre">sample1.py</span></code> の書き換えをさらにvscode上で行い、適宜追加・コミットを試してみましょう。</p>
</div>
<div class="section" id="id5">
<h2>今度は自分でやってみよう<a class="headerlink" href="#id5" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>今度は自分でやってみましょう。</p>
<ol class="arabic simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">sample2.py</span></code> を作ってみましょう、内容は何でも良いです(コードとしてエラーでない範囲で)。</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">sample2.py</span></code> をコミットしてみましょう。コミットメッセージはお好きにどうぞ。</p></li>
<li><p>このとき、ワークツリー状態とステージ、(狭義の)リポジトリ部分がどうなっているかを図示してみましょう。</p></li>
</ol>
<p>vscodeやEclipseでも同様の操作で行えますから、自分でファイルを作ってコミットしていきましょう。</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../lv2/index.html" class="btn btn-neutral float-right" title="レベル2: ブランチ操作" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="init.html" class="btn btn-neutral float-left" title="新規にリポジトリを作る" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, 佐藤 大輔.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>